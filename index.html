<!DOCTYPE html>
<html lang="ko">
<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-90860253-2"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'UA-90860253-2');
	</script>

	<meta charset="utf-8">
	<meta http-equiv="Content-Script-Type" content="text/javascript">
	<meta http-equiv="Content-Style-Type" content="text/css">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">

	<link rel="stylesheet" type="text/css" href="style.css?ver=7.01">
    <link rel="stylesheet" type="text/css" href="animate.css?ver=1.7">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>

	<title>Circles</title>
</head>
<body>

<canvas id="cvs"></canvas>

<script type="text/javascript">

let cvs = document.getElementById("cvs");
let ctx = cvs.getContext("2d");

cvs.width = window.innerWidth;
cvs.height = window.innerHeight;
ctx.globalCompositeOperation = '';

console.log(cvs, ctx);

let setting = {
    speed: 1,
    size: {
        max: 6,
        min: 3,
    },
    circles: 100,
}

function drawCircle(c) {
    ctx.beginPath();
    ctx.arc(c.x, c.y, c.size, 0, 2 * Math.PI);
    ctx.fillStyle = c.color;
    ctx.fill();
}

class Circle {
    constructor(x, y, speed, size, color) {
        this.x = x;
        this.y = y;
        this.speed = speed || setting.speed;
        this.size = size || Math.floor(Math.random() * setting.size.max + setting.size.min);
        this.color = color || '#ddd';
    }
    
    moveX() {
        this.x += (Math.random() < 0.5 ? -1 : 1) * this.speed;
    }

    moveY() {
        this.y += (Math.random() < 0.5 ? -1 : 1) * this.speed;
    }

    size(n) {
        this.size = n;
    }
}

function init(num) {
    const new_circles = [];

    for (let i = 0; i < num; i++) {
        new_circles.push(createCircle());
    }

    return new_circles;
}

let circles = init(setting.circles);
let loop = setInterval(() => update(), 10);

function update() {
    ctx.clearRect(0, 0, cvs.width, cvs.height);

    for (let i = 0; i < circles.length; i++) {
        let c = circles[i];

        if (c.x + c.speed*2 > cvs.width - c.size || c.x + c.speed*2 < c.size) {
            console.log('x');
            c.moveX();
        }
        if (c.y + c.speed*2 > cvs.height - c.size || c.y + c.speed*2 < c.size) {
            console.log('y');
            c.moveY();
        }

        // for (let j = 0; j < circles.length; j++) {
        //     let c2 = circles[j];
        //     if (i != j && Math.abs(c.x - c2.x) < line_distance && Math.abs(c.y - c2.y) < line_distance) {
        //         let l = {
        //             from: { x: c.x, y: c.y },
        //             to: { x: c2.x, y: c2.y },
        //             color: '#f1f0f1',
        //         }
        //         drawLine(l);
        //     }
        // }
        drawCircle(c);
    }
}

function createCircle() {
    let x = randomInt(30, cvs.width - 30),
        y = randomInt(30, cvs.height - 30);

    return new Circle(x, y);
}

function randomInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function randomColor() {
    let letters = '0123456789ABCDEF';
    let color = '#';
    for (let i = 0; i < 6; i++) {
        color += letters[Math.floor(Math.random() * letters.length)];
    }
    return color;
}

window.onresize = function(event) {
    cvs.width = window.innerWidth;
    cvs.height = window.innerHeight;

	setting.circles = 150,
	setting.size = { min: 1, max: 2 }

	if (window.innerWidth < 800) {
		setting.circles = 70
		setting.size = { min: 1, max: 2 }
	}

    circles = init(setting.circles);
};

</script>

</body>
</html>
